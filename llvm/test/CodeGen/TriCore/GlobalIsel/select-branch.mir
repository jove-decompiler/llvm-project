# RUN: llc -mtriple=tricore -global-isel -run-pass=instruction-select -verify-machineinstrs %s -o - | FileCheck %s

---
name:            unconditional_branch
legalized:       true
regBankSelected: true
body:             |
  ; CHECK-LABEL: name: unconditional_branch
  ; CHECK:  body:
  ; CHECK:   bb.0:
  ; CHECK:    successors: %bb.0
  ; CHECK:    J %bb.0
  bb.0:
    successors: %bb.0

    G_BR %bb.0
...

---
name:            conditional_branch_ne
legalized:       true
regBankSelected: true
registers:
  - { id: 0, class: dataregbank }
  - { id: 1, class: dataregbank }
  - { id: 2, class: dataregbank }
  - { id: 3, class: dataregbank }
body:             |
  ; CHECK-LABEL: name: conditional_branch_ne
  ; CHECK:  body:
  ; CHECK:   bb.0:
  ; CHECK:    [[COPY:%[0-9]+]]:dataregs = COPY $d4
  ; CHECK:    [[COPY1:%[0-9]+]]:dataregs = COPY $d5
  ; CHECK:    JNE_ddc [[COPY]], [[COPY1]], %bb.1
  ; CHECK:    J %bb.0
  bb.0:
    successors: %bb.0, %bb.1
    %0(s32) = COPY $d4
    %1(s32) = COPY $d5
    %2(s32) = G_ICMP intpred(ne), %0(s32), %1
    %3(s1) = G_TRUNC %2
    G_BRCOND %3(s1), %bb.1
    G_BR %bb.0

  bb.1:
...

---
name:            conditional_branch_eq
legalized:       true
regBankSelected: true
registers:
  - { id: 0, class: dataregbank }
  - { id: 1, class: dataregbank }
  - { id: 2, class: dataregbank }
  - { id: 3, class: dataregbank }
body:             |
  ; CHECK-LABEL: name: conditional_branch_eq
  ; CHECK:  body:
  ; CHECK:   bb.0:
  ; CHECK:    [[COPY:%[0-9]+]]:dataregs = COPY $d4
  ; CHECK:    [[COPY1:%[0-9]+]]:dataregs = COPY $d5
  ; CHECK:    JEQ_ddc [[COPY]], [[COPY1]], %bb.1
  ; CHECK:    J %bb.0
  bb.0:
    successors: %bb.0, %bb.1
    %0(s32) = COPY $d4
    %1(s32) = COPY $d5
    %2(s32) = G_ICMP intpred(eq), %0(s32), %1
    %3(s1) = G_TRUNC %2
    G_BRCOND %3(s1), %bb.1
    G_BR %bb.0

  bb.1:
...

---
name:            conditional_branch_ne_p0
legalized:       true
regBankSelected: true
registers:
  - { id: 0, class: addrregbank }
  - { id: 1, class: addrregbank }
  - { id: 2, class: dataregbank }
  - { id: 3, class: dataregbank }
body:             |
  ; CHECK-LABEL: name: conditional_branch_ne_p0
  ; CHECK:  body:
  ; CHECK:   bb.0:
  ; CHECK:    [[COPY:%[0-9]+]]:addrregs = COPY $a4
  ; CHECK:    [[COPY1:%[0-9]+]]:addrregs = COPY $a5
  ; CHECK:    JNEA_aac [[COPY]], [[COPY1]], %bb.1
  ; CHECK:    J %bb.0
  bb.0:
    successors: %bb.0, %bb.1
    %0(s32) = COPY $a4
    %1(s32) = COPY $a5
    %2(s32) = G_ICMP intpred(ne), %0(s32), %1
    %3(s1) = G_TRUNC %2
    G_BRCOND %3(s1), %bb.1
    G_BR %bb.0

  bb.1:
...

---
name:            conditional_branch_eq_p0
legalized:       true
regBankSelected: true
registers:
  - { id: 0, class: addrregbank }
  - { id: 1, class: addrregbank }
  - { id: 2, class: dataregbank }
  - { id: 3, class: dataregbank }
body:             |
  ; CHECK-LABEL: name: conditional_branch_eq_p0
  ; CHECK:  body:
  ; CHECK:   bb.0:
  ; CHECK:    [[COPY:%[0-9]+]]:addrregs = COPY $a4
  ; CHECK:    [[COPY1:%[0-9]+]]:addrregs = COPY $a5
  ; CHECK:    JEQA_aac [[COPY]], [[COPY1]], %bb.1
  ; CHECK:    J %bb.0
  bb.0:
    successors: %bb.0, %bb.1
    %0(s32) = COPY $a4
    %1(s32) = COPY $a5
    %2(s32) = G_ICMP intpred(eq), %0(s32), %1
    %3(s1) = G_TRUNC %2
    G_BRCOND %3(s1), %bb.1
    G_BR %bb.0

  bb.1:
...

---
name:            conditional_branch_ge
legalized:       true
regBankSelected: true
registers:
  - { id: 0, class: dataregbank }
  - { id: 1, class: dataregbank }
  - { id: 2, class: dataregbank }
  - { id: 3, class: dataregbank }
body:             |
  ; CHECK-LABEL: name: conditional_branch_ge
  ; CHECK:  body:
  ; CHECK:   bb.0:
  ; CHECK:    [[COPY:%[0-9]+]]:dataregs = COPY $d4
  ; CHECK:    [[COPY1:%[0-9]+]]:dataregs = COPY $d5
  ; CHECK:    JGE_ddc [[COPY]], [[COPY1]], %bb.1
  ; CHECK:    J %bb.0
  bb.0:
    successors: %bb.0, %bb.1
    %0(s32) = COPY $d4
    %1(s32) = COPY $d5
    %2(s32) = G_ICMP intpred(sge), %0(s32), %1
    %3(s1) = G_TRUNC %2
    G_BRCOND %3(s1), %bb.1
    G_BR %bb.0

  bb.1:
...

---
name:            conditional_branch_geu
legalized:       true
regBankSelected: true
registers:
  - { id: 0, class: dataregbank }
  - { id: 1, class: dataregbank }
  - { id: 2, class: dataregbank }
  - { id: 3, class: dataregbank }
body:             |
  ; CHECK-LABEL: name: conditional_branch_geu
  ; CHECK:  body:
  ; CHECK:   bb.0:
  ; CHECK:    [[COPY:%[0-9]+]]:dataregs = COPY $d4
  ; CHECK:    [[COPY1:%[0-9]+]]:dataregs = COPY $d5
  ; CHECK:    JGEU_ddc [[COPY]], [[COPY1]], %bb.1
  ; CHECK:    J %bb.0
  bb.0:
    successors: %bb.0, %bb.1
    %0(s32) = COPY $d4
    %1(s32) = COPY $d5
    %2(s32) = G_ICMP intpred(uge), %0(s32), %1
    %3(s1) = G_TRUNC %2
    G_BRCOND %3(s1), %bb.1
    G_BR %bb.0

  bb.1:
...

---
name:            conditional_branch_lt
legalized:       true
regBankSelected: true
registers:
  - { id: 0, class: dataregbank }
  - { id: 1, class: dataregbank }
  - { id: 2, class: dataregbank }
  - { id: 3, class: dataregbank }
body:             |
  ; CHECK-LABEL: name: conditional_branch_lt
  ; CHECK:  body:
  ; CHECK:   bb.0:
  ; CHECK:    [[COPY:%[0-9]+]]:dataregs = COPY $d4
  ; CHECK:    [[COPY1:%[0-9]+]]:dataregs = COPY $d5
  ; CHECK:    JLT_ddc [[COPY]], [[COPY1]], %bb.1
  ; CHECK:    J %bb.0
  bb.0:
    successors: %bb.0, %bb.1
    %0(s32) = COPY $d4
    %1(s32) = COPY $d5
    %2(s32) = G_ICMP intpred(slt), %0(s32), %1
    %3(s1) = G_TRUNC %2
    G_BRCOND %3(s1), %bb.1
    G_BR %bb.0

  bb.1:
...

---
name:            conditional_branch_ltu
legalized:       true
regBankSelected: true
registers:
  - { id: 0, class: dataregbank }
  - { id: 1, class: dataregbank }
  - { id: 2, class: dataregbank }
  - { id: 3, class: dataregbank }
body:             |
  ; CHECK-LABEL: name: conditional_branch_ltu
  ; CHECK:  body:
  ; CHECK:   bb.0:
  ; CHECK:    [[COPY:%[0-9]+]]:dataregs = COPY $d4
  ; CHECK:    [[COPY1:%[0-9]+]]:dataregs = COPY $d5
  ; CHECK:    JLTU_ddc [[COPY]], [[COPY1]], %bb.1
  ; CHECK:    J %bb.0
  bb.0:
    successors: %bb.0, %bb.1
    %0(s32) = COPY $d4
    %1(s32) = COPY $d5
    %2(s32) = G_ICMP intpred(ult), %0(s32), %1
    %3(s1) = G_TRUNC %2
    G_BRCOND %3(s1), %bb.1
    G_BR %bb.0

  bb.1:
...

---
name:            conditional_branch_gt
legalized:       true
regBankSelected: true
registers:
  - { id: 0, class: dataregbank }
  - { id: 1, class: dataregbank }
  - { id: 2, class: dataregbank }
  - { id: 3, class: dataregbank }
body:             |
  ; CHECK-LABEL: name: conditional_branch_gt
  ; CHECK:  body:
  ; CHECK:   bb.0:
  ; CHECK:    [[COPY:%[0-9]+]]:dataregs = COPY $d4
  ; CHECK:    [[COPY1:%[0-9]+]]:dataregs = COPY $d5
  ; CHECK:    JLT_ddc [[COPY1]], [[COPY]], %bb.1
  ; CHECK:    J %bb.0
  bb.0:
    successors: %bb.0, %bb.1
    %0(s32) = COPY $d4
    %1(s32) = COPY $d5
    %2(s32) = G_ICMP intpred(sgt), %0(s32), %1
    %3(s1) = G_TRUNC %2
    G_BRCOND %3(s1), %bb.1
    G_BR %bb.0

  bb.1:
...

---
name:            conditional_branch_gtu
legalized:       true
regBankSelected: true
registers:
  - { id: 0, class: dataregbank }
  - { id: 1, class: dataregbank }
  - { id: 2, class: dataregbank }
  - { id: 3, class: dataregbank }
body:             |
  ; CHECK-LABEL: name: conditional_branch_gtu
  ; CHECK:  body:
  ; CHECK:   bb.0:
  ; CHECK:    [[COPY:%[0-9]+]]:dataregs = COPY $d4
  ; CHECK:    [[COPY1:%[0-9]+]]:dataregs = COPY $d5
  ; CHECK:    JLTU_ddc [[COPY1]], [[COPY]], %bb.1
  ; CHECK:    J %bb.0
  bb.0:
    successors: %bb.0, %bb.1
    %0(s32) = COPY $d4
    %1(s32) = COPY $d5
    %2(s32) = G_ICMP intpred(ugt), %0(s32), %1
    %3(s1) = G_TRUNC %2
    G_BRCOND %3(s1), %bb.1
    G_BR %bb.0

  bb.1:
...

---
name:            conditional_branch_le
legalized:       true
regBankSelected: true
registers:
  - { id: 0, class: dataregbank }
  - { id: 1, class: dataregbank }
  - { id: 2, class: dataregbank }
  - { id: 3, class: dataregbank }
body:             |
  ; CHECK-LABEL: name: conditional_branch_le
  ; CHECK:  body:
  ; CHECK:   bb.0:
  ; CHECK:    [[COPY:%[0-9]+]]:dataregs = COPY $d4
  ; CHECK:    [[COPY1:%[0-9]+]]:dataregs = COPY $d5
  ; CHECK:    JGE_ddc [[COPY1]], [[COPY]], %bb.1
  ; CHECK:    J %bb.0
  bb.0:
    successors: %bb.0, %bb.1
    %0(s32) = COPY $d4
    %1(s32) = COPY $d5
    %2(s32) = G_ICMP intpred(sle), %0(s32), %1
    %3(s1) = G_TRUNC %2
    G_BRCOND %3(s1), %bb.1
    G_BR %bb.0

  bb.1:
...

---
name:            conditional_branch_leu
legalized:       true
regBankSelected: true
registers:
  - { id: 0, class: dataregbank }
  - { id: 1, class: dataregbank }
  - { id: 2, class: dataregbank }
  - { id: 3, class: dataregbank }
body:             |
  ; CHECK-LABEL: name: conditional_branch_leu
  ; CHECK:  body:
  ; CHECK:   bb.0:
  ; CHECK:    [[COPY:%[0-9]+]]:dataregs = COPY $d4
  ; CHECK:    [[COPY1:%[0-9]+]]:dataregs = COPY $d5
  ; CHECK:    JGEU_ddc [[COPY1]], [[COPY]], %bb.1
  ; CHECK:    J %bb.0
  bb.0:
    successors: %bb.0, %bb.1
    %0(s32) = COPY $d4
    %1(s32) = COPY $d5
    %2(s32) = G_ICMP intpred(ule), %0(s32), %1
    %3(s1) = G_TRUNC %2
    G_BRCOND %3(s1), %bb.1
    G_BR %bb.0

  bb.1:
...

---
name:            conditional_branch_s1
legalized:       true
regBankSelected: true
registers:
  - { id: 0, class: dataregbank }
  - { id: 1, class: dataregbank }
body:             |
  ; CHECK-LABEL: name: conditional_branch_s1
  ; CHECK:  body:
  ; CHECK:   bb.0:
  ; CHECK:    [[COPY:%[0-9]+]]:dataregs = COPY $d4
  ; CHECK:    JNE_dcc [[COPY]], 0, %bb.1
  ; CHECK:    J %bb.0
  bb.0:
    successors: %bb.0, %bb.1
    %1(s32) = COPY $d4
    %0(s1) = G_TRUNC %1
    G_BRCOND %0(s1), %bb.1
    G_BR %bb.0

  bb.1:
...

---
name:            conditional_branch_s32
legalized:       true
regBankSelected: true
registers:
  - { id: 0, class: dataregbank }
body:             |
  ; CHECK-LABEL: name: conditional_branch
  ; CHECK:  body:
  ; CHECK:   bb.0:
  ; CHECK:    [[COPY:%[0-9]+]]:dataregs = COPY $d4
  ; CHECK:    JNE_dcc [[COPY]], 0, %bb.1
  ; CHECK:    J %bb.0
  bb.0:
    successors: %bb.0, %bb.1
    %0(s32) = COPY $d4
    G_BRCOND %0(s32), %bb.1
    G_BR %bb.0

  bb.1:
...

---
name:            conditional_branch_addrregs
legalized:       true
regBankSelected: true
registers:
  - { id: 0, class: addrregbank }
body:             |
  ; CHECK-LABEL: name: conditional_branch
  ; CHECK:  body:
  ; CHECK:   bb.0:
  ; CHECK:    [[COPY:%[0-9]+]]:addrregs = COPY $a4
  ; CHECK:    JNZA_ac [[COPY]], %bb.1
  ; CHECK:    J %bb.0
  bb.0:
    successors: %bb.0, %bb.1
    %0(s32) = COPY $a4
    G_BRCOND %0(s32), %bb.1
    G_BR %bb.0

  bb.1:
...

---
name:            indirect_branch
legalized:       true
regBankSelected: true
registers:
  - { id: 0, class: addrregbank }
body:             |
  ; CHECK-LABEL: name: indirect_branch
  ; CHECK:  body:
  ; CHECK:   bb.0:
  ; CHECK:    [[COPY:%[0-9]+]]:addrregs = COPY $a2
  ; CHECK:    JI [[COPY]]
  bb.0:
    successors: %bb.0, %bb.1
    %0(p0) = COPY $a2
    G_BRINDIRECT %0(p0)

  bb.1:
...
